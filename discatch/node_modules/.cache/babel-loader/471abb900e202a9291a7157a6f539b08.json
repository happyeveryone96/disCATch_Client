{"ast":null,"code":"// LIBRARY\nimport { createSlice } from '@reduxjs/toolkit';\nimport instance from '../../shared/axios'; // REDUX\n\nimport { imgActions } from './image'; // 커뮤니티 글 등록\n\nexport const addCommunityDB = (category, contents, location, title) => {\n  return function (dispatch, getState, {\n    history\n  }) {\n    const imgFile = getState().image.file; // const username = getState().user; // 나중에 가져오기\n\n    const username = '뽀삐맘';\n    console.log(imgFile);\n    console.log(username);\n\n    if (0 < imgFile.length < 6) {\n      dispatch(imgActions.uploadImageDB(() => {\n        const imageUrl = getState().image.imageUrl;\n        const postInfo = {\n          categoty: category,\n          contents: contents,\n          image: imageUrl,\n          location: location,\n          title: title,\n          username: username\n        };\n        instance.post('/community/create', postInfo).then(res => {\n          dispatch(addCommunity(postInfo));\n          dispatch(imgActions.setInitialState());\n          history.goBack();\n        }).catch(err => {\n          console.log(err);\n        });\n      }));\n    }\n\n    return;\n  };\n}; // 커뮤니티 글 가져오기\n\nexport const getCommunityDB = (limit = 10, location, category) => {\n  return function (dispatch, getState, {\n    history\n  }) {\n    instance.get(`/community/location/${location}?categoty=${category}&?page=0&?size=${limit}`).then(res => {\n      let communityList = res.data;\n\n      if (communityList.length < limit + 1) {\n        dispatch(getCommunity(communityList, null));\n        return;\n      }\n\n      dispatch(getCommunity(communityList, limit));\n    }).catch(err => {\n      window.alert('페이지에 오류가 있어요!');\n      console.log(err);\n    });\n  };\n}; // 커뮤니티 상세 가져오기\n\nexport const getOneCommunityDB = (communityId = '') => {\n  return function (dispatch, getState, {\n    history\n  }) {\n    instance.get(`/community/${communityId.communityId}`).then(res => {\n      let detailCommunity = res.data;\n      dispatch(getOneCommunity(detailCommunity));\n    }).catch(err => {\n      console.error(err);\n      console.log(communityId);\n    });\n  };\n}; // 커뮤니티 수정\n\nexport const editCommunityDB = (communityId, category, contents, location, title) => {\n  return function (dispatch, getState, {\n    history\n  }) {\n    const imgFile = getState().image.file;\n    const username = '뽀삐맘'; // 나중에 수정\n\n    if (imgFile.length) {\n      dispatch(imgActions.uploadImageDB(() => {\n        const imageUrl = getState().image.imageUrl;\n        instance.put(`/community/${communityId}`, {\n          category: category,\n          contents: contents,\n          image: imageUrl,\n          location: location,\n          title: title,\n          username: username\n        }).then(res => {\n          window.alert('게시글 수정 완료');\n          history.goBack();\n        }).catch(err => {\n          console.error(err);\n        });\n      }));\n    }\n\n    return;\n  };\n}; // 커뮤니티 글 삭제\n\nexport const deleteCommunityDB = communityId => {\n  return function (dispatch, getState, {\n    history\n  }) {\n    instance.delete(`/community/${communityId.communityId}`).then(res => {\n      dispatch(deleteCommunity(communityId));\n      window.alert('게시물 삭제 완료');\n      history.push('/community');\n    }).catch(err => {\n      console.log(err);\n    });\n  };\n};\nconst initialState = {\n  list: [],\n  page: 0,\n  start: 0\n}; // 리듀서\n\nconst community = createSlice({\n  name: 'community',\n  initialState,\n  reducers: {\n    addCommunity: (state, action) => {\n      const categoty = action.payload.category;\n      const contents = action.payload.contents;\n      const image = action.payload.image;\n      const location = action.payload.location;\n      const title = action.payload.title;\n      const username = action.payload.username;\n      state.list.push(categoty, contents, image, location, title, username);\n    },\n    getCommunity: (state, action) => {\n      state.list = action.payload.content;\n      state.start = action.payload.number;\n    },\n    getMoreCommunity: (state, action) => {\n      return { ...state,\n        list: [...state.list, ...action.payload.content],\n        start: action.payload.number\n      };\n    },\n    getOneCommunity: (state, action) => {\n      state.list = action.payload;\n    },\n    editCommunity: (state, action) => {\n      console.log('수정 요청 완료!');\n    },\n    deleteCommunity: (state, action) => {\n      console.log('삭제 요청 완료!');\n    }\n  }\n});\nexport const {\n  addCommunity,\n  getCommunity,\n  editCommunity,\n  deleteCommunity,\n  getOneCommunity,\n  getMoreCommunity\n} = community.actions;\nexport default community;","map":{"version":3,"sources":["/Users/jinwoojung/Desktop/Streetcatshelter_Client/discatch/src/redux/modules/community.jsx"],"names":["createSlice","instance","imgActions","addCommunityDB","category","contents","location","title","dispatch","getState","history","imgFile","image","file","username","console","log","length","uploadImageDB","imageUrl","postInfo","categoty","post","then","res","addCommunity","setInitialState","goBack","catch","err","getCommunityDB","limit","get","communityList","data","getCommunity","window","alert","getOneCommunityDB","communityId","detailCommunity","getOneCommunity","error","editCommunityDB","put","deleteCommunityDB","delete","deleteCommunity","push","initialState","list","page","start","community","name","reducers","state","action","payload","content","number","getMoreCommunity","editCommunity","actions"],"mappings":"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","sourcesContent":["// LIBRARY\nimport { createSlice } from '@reduxjs/toolkit';\nimport instance from '../../shared/axios';\n\n// REDUX\nimport { imgActions } from './image';\n\n// 커뮤니티 글 등록\nexport const addCommunityDB = (category, contents, location, title) => {\n  return function (dispatch, getState, { history }) {\n    const imgFile = getState().image.file;\n    // const username = getState().user; // 나중에 가져오기\n    const username = '뽀삐맘';\n    console.log(imgFile);\n    console.log(username);\n    if (0<imgFile.length<6) {\n      dispatch(\n        imgActions.uploadImageDB(() => {\n          const imageUrl = getState().image.imageUrl;\n          const postInfo = {\n            categoty: category, \n            contents: contents, \n            image: imageUrl, \n            location: location, \n            title: title, \n            username: username,\n          };\n          instance\n            .post('/community/create', postInfo)\n            .then((res) => {\n              dispatch(addCommunity(postInfo));\n              dispatch(imgActions.setInitialState());\n              history.goBack();\n            })\n            .catch((err) => {\n              console.log(err);\n            });\n        }),\n      );\n    } \n    return;\n  };\n};\n\n// 커뮤니티 글 가져오기\nexport const getCommunityDB = (limit = 10,location,category) => {\n  return function (dispatch, getState, { history }) {\n    instance\n      .get(`/community/location/${location}?categoty=${category}&?page=0&?size=${limit}`)\n      .then((res) => {\n        let communityList = res.data;\n        if (communityList.length < limit + 1) {\n          dispatch(getCommunity(communityList, null));\n          return;\n        }\n\n        dispatch(getCommunity(communityList, limit));\n      })\n      .catch((err) => {\n        window.alert('페이지에 오류가 있어요!');\n        console.log(err);\n      });\n  };\n};\n\n// 커뮤니티 상세 가져오기\nexport const getOneCommunityDB = (communityId = '') => {\n  return function (dispatch, getState, { history }) {\n    instance\n      .get(`/community/${communityId.communityId}`)\n      .then((res) => {\n        let detailCommunity = res.data;\n        dispatch(getOneCommunity(detailCommunity));\n      })\n      .catch((err) => {\n        console.error(err);\n        console.log(communityId);\n      });\n  };\n};\n\n// 커뮤니티 수정\nexport const editCommunityDB = (communityId, category, contents, location, title) => {\n  return function (dispatch, getState, { history }) {\n    const imgFile = getState().image.file;\n    const username = '뽀삐맘'; // 나중에 수정\n    if (imgFile.length) {\n      dispatch(\n        imgActions.uploadImageDB(() => {\n          const imageUrl = getState().image.imageUrl;\n          instance\n            .put(`/community/${communityId}`, {\n              category: category,\n              contents: contents,\n              image: imageUrl,\n              location:location,\n              title: title,\n              username: username,\n            })\n            .then((res) => {\n              window.alert('게시글 수정 완료');\n              history.goBack();\n            })\n            .catch((err) => {\n              console.error(err);\n            });\n        }),\n      );\n    }\n    return;\n  };\n};\n\n// 커뮤니티 글 삭제\nexport const deleteCommunityDB = (communityId) => {\n  return function (dispatch, getState, { history }) {\n    instance\n      .delete(`/community/${communityId.communityId}`)\n      .then((res) => {\n        dispatch(deleteCommunity(communityId));\n        window.alert('게시물 삭제 완료');\n        history.push('/community');\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n  };\n};\n\nconst initialState = {\n  list: [],\n  page: 0,\n  start: 0,\n};\n\n// 리듀서\nconst community = createSlice({\n  name: 'community',\n  initialState,\n  reducers: {\n    addCommunity: (state, action) => {\n      const categoty = action.payload.category;\n      const contents = action.payload.contents;\n      const image = action.payload.image;\n      const location = action.payload.location;\n      const title = action.payload.title\n      const username = action.payload.username\n      state.list.push(categoty, contents, image, location, title, username);\n    },\n\n    getCommunity: (state, action) => {\n      state.list = action.payload.content;\n      state.start = action.payload.number;\n    },\n\n    getMoreCommunity: (state, action) => {\n      return {\n        ...state,\n        list: [...state.list, ...action.payload.content],\n        start: action.payload.number,\n      };\n    },\n\n    getOneCommunity: (state, action) => {\n      state.list = action.payload;\n    },\n\n    editCommunity: (state, action) => {\n      console.log('수정 요청 완료!');\n    },\n\n    deleteCommunity: (state, action) => {\n      console.log('삭제 요청 완료!');\n    },\n  },\n});\n\nexport const {\n  addCommunity,\n  getCommunity,\n  editCommunity,\n  deleteCommunity,\n  getOneCommunity,\n  getMoreCommunity,\n} = community.actions;\nexport default community;"]},"metadata":{},"sourceType":"module"}